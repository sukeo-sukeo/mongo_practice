<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no, minimal-ui">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <link href="https://fonts.googleapis.com/css?family=Roboto:100,300,400,500,700,900" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/@mdi/font@5.x/css/materialdesignicons.min.css" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/vuetify@2.x/dist/vuetify.min.css" rel="stylesheet">
  <!-- <link rel="stylesheet" href="./style.css"> -->
  <title>todoリスト</title>
</head>
<body>

  <div id="app">
    <top-page></top-page>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/vue@2.x/dist/vue.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/vuetify@2.x/dist/vuetify.js"></script>
  <script src="https://unpkg.com/vue-router@3.0.1"></script>
  <script src="https://unpkg.com/axios/dist/axios.min.js"></script>

  <script type="text/x-template" id="top-page">
    <v-app>

<!-- ヘッダーバー -->

      <v-app-bar app flat dark>
        <v-btn fab text small @click="changes.drawer = !changes.drawer">
          <v-icon>mdi-view-headline</v-icon>
        </v-btn>
        <v-toolbar-title class="text-uppercase display-2">
          <span class="font-weight-light">Todo</span>
          <span>list</span>
        </v-toolbar-title>
        <v-spacer></v-spacer>
        <v-btn text color="grey" class="text--lighten-2">
          <span>サインアウト</span>
          <v-icon right>mdi-exit-to-app</v-icon>
        </v-btn>
      </v-app-bar>

<!-- ナビゲーションバー -->

      <v-navigation-drawer app v-model="changes.drawer" class="purple">
        <p>test</p>
      </v-navigation-drawer>

<!-- タイトルメッセージ -->

      <v-main>

      <h2 align="center">I made it by practice vuetify!</h2>

<!-- 新規作成ボタン -->

      <v-row justify="center">
        <v-btn @click="changes.addTodoDialog = true"
         height="100"
         width="100"
         text
         class="my-6">
            <v-icon size="100">mdi-comment-edit-outline</v-icon>
        </v-btn>
      </v-row>

<!-- 新規作成フォームダイアログ -->

      <v-dialog v-model="changes.addTodoDialog" max-width="700">
        <v-card flat class="px-5">
          <v-form>
            <v-container>
              <v-row justify="start" class="">
                <v-btn @click.stop="changes.addTodoDialog = false" text>
                  <v-icon>mdi-arrow-left</v-icon>
                </v-btn>
              </v-row>
              <v-row>
                <v-text-field prepend-icon="mdi-draw" label="タイトル" v-model="todoData.title" autocomplete="off" clearable/>
              </v-row>

              <v-row>
                <v-col cols="12">
                  <v-textarea rows="5" prepend-icon="mdi-file-document-edit-outline" label="詳細" v-model="todoData.descript" autocomplete="off" clearable/>
                </v-col>
                <v-col cols="5">
                  <v-text-field prepend-icon="mdi-calendar-check" label="期限" v-model="todoData.limit" autocomplete="off" @click="changes.calendar = !changes.calendar" clearable/>
                  <v-dialog width="300" v-model="changes.calendar">
                    <v-date-picker v-model="todoData.limit" @click:date="changes.calendar = false"/>
                  </v-dialog>
                </v-col>
                <v-col cols="7">
                  <v-select
                   prepend-icon="mdi-tag-multiple-outline"
                  :items="tagItems"
                  v-model="tags"
                  label="カテゴリ"
                  clearable
                  multiple
                  >
                  </v-select>
                </v-col>
              </v-row>

              <v-row>
                <v-col>
                  <v-rating v-model="rating"></v-rating>
                </v-col>
                <v-col align-self="center">
                  <v-chip :class="ratingComment[rating].style" class="mb-0" outlined>
                    {{ ratingComment[rating].comment }}
                  </v-chip>
                </v-col>
              </v-row>

              <v-row>
                <v-col cols="9" sm="10">
                 <v-chip v-for="(tag, idx) in tags"
                  :key="idx"
                  close
                  @click:close="removeTage(tag)"
                  >
                  {{ tag }}
                  </v-chip>
                </v-col>
                <v-col cols="1">
                  <v-btn dark depressed color="success" @click.stop="addTodo">
                    <v-icon left>mdi-database-import</v-icon>
                    <span class="font-weight-bold">保存</span>
                  </v-btn>
                </v-col>
              </v-row>

            </v-container>
          </v-form>
        </v-card>
      </v-dialog>

<!-- 削除、編集の処理ダイアログ -->

        <v-container>
          <v-row justify="center">
            <v-col cols="10" sm="5"  v-for="(todo, idx) in todos" :key="todo._id">
              <v-card outlined hover  @click.stop="updBtn(idx)">
                <v-card-title>
                  {{ todo.title }}
                </v-card-title>
                <v-card-subtitle style="white-space: pre-wrap;">
                 <p>{{ todo.descript }}</p>
                </v-card-subtitle>
                <v-card-text>
                  {{ todo.limitDate }}
                </v-card-text>

                <v-dialog v-model="isActives[idx]" width="500">
                  <v-card>
                    <v-row justify="start" class="ml-1 pt-5">
                      <v-btn @click.stop="updBtn(idx)" text>
                        <v-icon>mdi-arrow-left</v-icon>
                      </v-btn>
                    </v-row>
                    <v-card-title>
                      <v-text-field v-model="updateTodoData.title"
                       autocomplete="off"
                       :label="!todo.title ? 'タスクを入力' : todo.title"
                      />
                    </v-card-title>
                    <v-card-text>
                      <v-textarea rows="5" v-model="updateTodoData.descript"
                       autocomplete="off"
                       :label="!todo.descript ? '詳細を入力' : todo.descript"
                      />
                      <v-text-field v-model="updateTodoData.limit"
                       autocomplete="off"
                       :label="!todo.limitDate ? '期限を入力' : todo.limitDate"
                       @click="changes.updateCalendar = true"
                      />
                    </v-card-text>
                    <v-dialog width="300" v-model="changes.updateCalendar">
                      <v-date-picker v-model="updateTodoData.limit" @click:date="changes.updateCalendar = false"/>
                    </v-dialog>
                    <v-card-actions>
                    <v-row justify="end" class="mr-5 mb-5">
                      <v-btn @click.stop="updateTodo(todo._id, idx)"
                      color="primary lighten-1"
                      fab
                      >
                        <v-icon>
                          mdi-circle-edit-outline
                        </v-icon>
                      </v-btn>
                    </v-row>
                    </v-card-actions>
                  </v-card>
                </v-dialog>

                <v-card-actions>
                  <v-row justify="start">
                    <v-btn @click.stop="deleteTodo(todo._id)" text small>
                      <v-icon>mdi-trash-can</v-icon>
                    </v-btn>
                  </v-row>
                </v-card-actions>

              </v-card>
            </v-col>
          </v-row>
        </v-container>

      </v-main>
    </v-app>
  </script>

  <script src="./main.js"></script>
</body>

</html>
